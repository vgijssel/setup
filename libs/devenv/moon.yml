language: javascript
layer: library
tags:
  - devenv
  - chezmoi
  - development-environment
  - macos
  - devenv
  - chezmoi
  - development-environment
  - macos
tasks:
  apply:
    command: chezmoi-wrapper apply --force --verbose
    options:
      runInCI: false
      interactive: true

  test:
    script: chezmoi-wrapper apply --force --verbose && goss validate
    deps:
      - vendir:build
    inputs:
      - glob: files/**/*
        cache: true
      - file: goss.yaml
      - file: chezmoi.yaml
      - file: /.chezmoiroot
      - "@globs(chezmoi_bin)"
      - "@globs(claude_bin)"
    options:
      cache: true
