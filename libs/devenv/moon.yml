language: javascript
layer: library
tags:
  - devenv
  - chezmoi
  - development-environment
  - macos
  - devenv
  - chezmoi
  - development-environment
  - macos
tasks:
  apply:
    command: chezmoi apply --verbose
    local: true

  test:
    # Initialize zsh after chezmoi apply to ensure zimfw downloads modules before goss tests
    command: bash -c "chezmoi apply --force --verbose && zsh -ic 'true' && goss validate"
    deps:
      - claude-code:build
    inputs:
      - glob: files/**/*
        cache: true
      - file: goss.yaml
      - file: chezmoi.yaml
      - file: /.chezmoiroot
    options:
      cache: true
