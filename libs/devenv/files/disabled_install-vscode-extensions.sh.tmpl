#!/usr/bin/env bash
set -euo pipefail

# DISABLED: This script is temporarily disabled due to VSCode CLI hanging on macOS
# See: https://github.com/microsoft/vscode/issues/269737
# To re-enable, rename this file to: run_onchange_install-vscode-extensions.sh.tmpl

{{- $setup_dir := env "SETUP_DIR" }}
{{- $extensions_file := joinPath $setup_dir ".vscode" "extensions.json" }}

# extensions hash: {{ output "cat" $extensions_file | sha256sum }}

EXT_FILE="{{ $extensions_file }}"

echo "ðŸ“¦ Installing VSCode extensions listed in $EXT_FILE..."

jq -r '.recommendations[]' "$EXT_FILE" | while read -r extension; do
    echo "âž• Installing $extension..."
    code --install-extension "$extension" --force
done

echo "âœ… All extensions installed!"