type: library
language: bash

tasks:
  build:
    command: echo $MOON_TASK_HASH > run.sha
    inputs:
      - devcontainer-install-extensions.sh
    outputs:
      - run.sha
    options:
      cache: true
      runInCI: true

  run:
    command: ./devcontainer-install-extensions.sh
    local: true
    options:
      runInCI: false

  test:
    command: bats
    args:
      - tests/test.bats
    inputs:
      - devcontainer-install-extensions.sh
      - tests/**
      - "@globs(code-server_bin)"
    options:
      cache: true
      runInCI: true
