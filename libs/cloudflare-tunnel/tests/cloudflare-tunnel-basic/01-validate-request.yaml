apiVersion: kuttl.dev/v1beta1
kind: TestStep
metadata:
  name: validate-http-request
commands:
  # Test HTTP request to the tunnel hostname
  - command: curl -s -o /dev/null -w "%{http_code}" https://$NAMESPACE.vgijssel-dev.nl
    namespaced: false
  # Validate we get a 200 response
  - script: |
      response_code=$(curl -s -o /dev/null -w "%{http_code}" https://$NAMESPACE.vgijssel-dev.nl)
      if [ "$response_code" = "200" ]; then
        echo "SUCCESS: Got HTTP 200 response from $NAMESPACE.vgijssel-dev.nl"
        exit 0
      else
        echo "FAILED: Got HTTP $response_code response from $NAMESPACE.vgijssel-dev.nl, expected 200"
        exit 1
      fi
