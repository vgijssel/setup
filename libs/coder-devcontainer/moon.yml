language: javascript
layer: library
dependsOn:
  - devcontainer
tags:
  - coder
  - devcontainer
  - terraform
  - development-environment
tasks:
  init:
    command: terraform init -backend=false
    options:
      cache: true
    outputs:
      - .terraform
    inputs:
      - glob: ./**/*.tf
      - glob: ./**/*.hcl

  test:
    command: terraform validate
    deps:
      - ~:init
    options:
      cache: true
    inputs:
      - glob: ./**/*.tf
      - glob: ./**/*.hcl
      - file: ./package.json
      - file: ./supervisord.conf
      - file: ./Taskfile.yml
      - file: ./version.txt
