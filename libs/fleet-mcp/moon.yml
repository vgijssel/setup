language: javascript
tags:
  - type.lib
  - scope.infrastructure
  - type.lib
  - scope.infrastructure
tasks:
  build:
    command: uv build
    env:
      CWD: libs/fleet-mcp
    inputs:
      - glob: "**/*.*"
        cache: true
      - glob: "!.venv/**"
        cache: true
      - glob: "!dist/**"
        cache: true
      - glob: "!.pytest_cache/**"
        cache: true
      - glob: "!**/__pycache__/**"
        cache: true
    outputs:
      - libs/fleet-mcp/dist
    options:
      cache: true
  lint:
    command: uv run lint-imports
    env:
      CWD: libs/fleet-mcp
    inputs:
      - glob: src/**/*.py
        cache: true
      - file: pyproject.toml
      - glob: "!.venv/**"
        cache: true
      - glob: "!**/__pycache__/**"
        cache: true
    options:
      cache: true
  release:
    command: "./release.sh"
    env:
      CWD: libs/fleet-mcp
    inputs:
      - glob: src/**/*.py
        cache: true
      - file: pyproject.toml
      - file: release.sh
      - glob: "!.venv/**"
        cache: true
      - glob: "!dist/**"
        cache: true
      - glob: "!**/__pycache__/**"
        cache: true
    local: true
    options:
      cache: true
  server:
    command: FLEET_MCP_AUTH_ENABLED=true FLEET_MCP_TASKFILE=/workspaces/setup/libs/coder-devcontainer/Taskfile.yml uv run --all-extras uvicorn fleet_mcp.__main__:app --host 127.0.0.1 --port 8000 --reload --timeout-graceful-shutdown 3
    env:
      CWD: libs/fleet-mcp
    local: true
  test:
    command: uv run pytest
    env:
      CWD: libs/fleet-mcp
    inputs:
      - glob: src/**/*.py
        cache: true
      - glob: tests/**/*.py
        cache: true
      - file: pyproject.toml
      - glob: "!.venv/**"
        cache: true
      - glob: "!.pytest_cache/**"
        cache: true
      - glob: "!**/__pycache__/**"
        cache: true
    outputs:
      - ".coverage"
      - htmlcov
    options:
      cache: true
