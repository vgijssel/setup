# Thread/Matter Network Kernel Configuration
# Managed by Ansible - DO NOT EDIT MANUALLY
# Required for OTBR (Open Thread Border Router) operation

# IPv6 Forwarding (REQUIRED for Thread network routing)
net.ipv6.conf.all.forwarding=1
net.ipv6.conf.default.forwarding=1

# IPv4 Forwarding (for NAT64 if enabled)
net.ipv4.ip_forward=1

# Multicast Configuration (REQUIRED for mDNS/Thread)
net.ipv6.conf.all.mc_forwarding=1
net.ipv6.conf.default.mc_forwarding=1

# Neighbor Discovery Cache Settings
# Increased thresholds for Thread mesh networks with many devices
net.ipv6.neigh.default.gc_thresh1=1024
net.ipv6.neigh.default.gc_thresh2=2048
net.ipv6.neigh.default.gc_thresh3=4096

# Accept Router Advertisements even with forwarding enabled
# Value 2 means accept RAs even when forwarding is on
net.ipv6.conf.all.accept_ra=2
net.ipv6.conf.default.accept_ra=2
net.ipv6.conf.{{ otbr_backbone_interface }}.accept_ra=2

# Disable privacy extensions for stable IPv6 addresses
# Thread devices need predictable addresses
net.ipv6.conf.all.use_tempaddr=0
net.ipv6.conf.default.use_tempaddr=0

# Proxy NDP (Neighbor Discovery Protocol)
# Required for Thread border routing
net.ipv6.conf.all.proxy_ndp=1
net.ipv6.conf.default.proxy_ndp=1
