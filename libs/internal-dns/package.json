{
  "name": "internal-dns",
  "version": "1.1.0",
  "type": "commonjs",
  "nx": {
    "projectType": "library",
    "sourceRoot": "libs/internal-dns",
    "targets": {
      "secrets": {
        "executor": "nx:run-commands",
        "options": {
          "command": "echo \"apiToken: $(op read 'op://setup-devenv/cloudflare-tunnel/credential')\" > secrets.yaml",
          "cwd": "libs/internal-dns"
        },
        "cache": true,
        "inputs": [],
        "outputs": [
          "{projectRoot}/secrets.yaml"
        ]
      },
      "test": {
        "executor": "nx:run-commands",
        "options": {
          "commands": [
            "kind create cluster --name internal-dns-test --kubeconfig ./kubeconfig --wait 2m || echo 'Cluster might already exist'",
            "export KUBECONFIG=./kubeconfig && chainsaw test --test-dir chainsaw-test --config chainsaw-test.yaml",
            "kind delete cluster --name internal-dns-test || true"
          ],
          "parallel": false,
          "cwd": "libs/internal-dns",
          "configurations": {
            "dev": {
              "command": "chainsaw test --test-dir chainsaw-test --config chainsaw-test.yaml --no-cluster"
            }
          }
        },
        "cache": true,
        "inputs": [
          "{projectRoot}/**/*",
          "!{projectRoot}/kind-logs-*/**/*",
          "!{projectRoot}/kubeconfig",
          "!{projectRoot}/secrets.yaml",
          {
            "env": "NX_TASK_TARGET_CONFIGURATION"
          }
        ],
        "outputs": [],
        "dependsOn": [
          "secrets"
        ]
      }
    },
    "tags": [
      "type:library",
      "scope:infrastructure",
      "platform:kubernetes"
    ]
  },
  "private": true
}
