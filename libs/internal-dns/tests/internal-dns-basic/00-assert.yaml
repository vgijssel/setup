# Validate MetalLB is running
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: metallb-speaker
  namespace: metallb-system
status:
  numberReady: 1

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: metallb-controller
  namespace: metallb-system
status:
  readyReplicas: 1
  availableReplicas: 1

---
# Validate nginx ingress is running
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx
status:
  readyReplicas: 1
  availableReplicas: 1

---
# Validate internal-dns deployment is running
apiVersion: apps/v1
kind: Deployment
metadata:
  name: internal-dns-test
status:
  readyReplicas: 1
  availableReplicas: 1

---
# Validate internal-dns service is correct
apiVersion: v1
kind: Service
metadata:
  name: internal-dns-test
spec:
  type: LoadBalancer
  ports:
  - port: 53
    protocol: UDP
    name: dns-udp
  - port: 53
    protocol: TCP
    name: dns-tcp
  - port: 8081
    protocol: TCP
    name: api

---
# Validate PVC is created
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: internal-dns-test-data
status:
  phase: Bound