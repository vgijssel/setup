apiVersion: chainsaw.kyverno.io/v1alpha1
kind: Test
metadata:
  name: cluster-setup
spec:
  description: Create kind cluster for testing
  steps:
    - name: Create kind cluster
      try:
        - script:
            timeout: 3m
            content: |
              set -e
              echo "Creating kind cluster..."
              kind create cluster --name chainsaw-test --kubeconfig ./kubeconfig --wait 2m
              echo "Kind cluster created successfully"
      cleanup:
        - script:
            content: |
              set -e
              echo "Deleting kind cluster..."
              kind delete cluster --name chainsaw-test || true
              rm -f ./kubeconfig
              echo "Cleanup complete"
