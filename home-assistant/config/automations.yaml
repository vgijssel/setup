- id: '1654118627011'
  alias: 'Office - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.office_presence
    to: 'on'
    from: 'off'
  - platform: numeric_state
    entity_id: sensor.motion_sensor_illuminance
    below: '80'
  condition:
  - condition: state
    entity_id: input_boolean.office_presence
    state: 'on'
  - type: is_illuminance
    condition: device
    device_id: f454d32984b16796fb074bd7ba162ef3
    entity_id: sensor.motion_sensor_illuminance
    domain: sensor
    below: 80
  action:
  - type: turn_on
    device_id: 882cfcb14e97e1a10ee2bb413e104af2
    entity_id: switch.office_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.office_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: 882cfcb14e97e1a10ee2bb413e104af2
    entity_id: switch.office_shelly
    domain: switch
  mode: single
- id: '1654167850551'
  alias: 'Supply Closet - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.supply_closet_presence
    from: 'off'
    to: 'on'
  condition: []
  action:
  - type: turn_on
    device_id: 4fdcffe73d9aa250e26599761c1a19dd
    entity_id: switch.supply_closet_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.supply_closet_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: 4fdcffe73d9aa250e26599761c1a19dd
    entity_id: switch.supply_closet_shelly
    domain: switch
  mode: single
- id: '1654670650990'
  alias: 'Living Room - Lights: Manual Toggle'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.living_room_shelly_input
  condition: []
  action:
  - if:
    - condition: state
      entity_id: light.living_room_lights
      state: 'on'
    then:
    - service: light.turn_off
      data:
        transition: 1
      target:
        entity_id: light.living_room_lights
    else:
    - service: scene.turn_on
      data:
        transition: 2
      target:
        entity_id: scene.living_room_relax
  mode: single
- id: '1654679985339'
  alias: 'Laundry Room - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.laundry_room_presence
    from: 'off'
    to: 'on'
  condition: []
  action:
  - type: turn_on
    device_id: b0fbe5b3c69086de8cb4d79adaddbcb4
    entity_id: switch.laundry_room_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.laundry_room_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: b0fbe5b3c69086de8cb4d79adaddbcb4
    entity_id: switch.laundry_room_shelly
    domain: switch
  mode: single
- id: '1654712522580'
  alias: 'Toilet - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.toilet_presence
    from: 'off'
    to: 'on'
  condition: []
  action:
  - type: turn_on
    device_id: 30d480fafab423619f5acb1a5830427b
    entity_id: switch.toilet_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.toilet_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: 30d480fafab423619f5acb1a5830427b
    entity_id: switch.toilet_shelly
    domain: switch
  mode: single
- id: '1654888062741'
  alias: 'Living Room - Watching: Manage'
  description: ''
  trigger:
  - platform: device
    device_id: e9121935f1d5a2f516790f9a116fa1f0
    domain: media_player
    entity_id: media_player.living_room_tv
    type: playing
    for:
      hours: 0
      minutes: 0
      seconds: 15
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: media_player.living_room_tv
      attribute: app_name
      state: Netflix
    - condition: state
      entity_id: media_player.living_room_tv
      attribute: app_name
      state: Prime Video
  action:
  - service: light.turn_on
    data:
      transition: 5
      brightness_pct: 30
      color_temp: 500
    target:
      area_id: living_room
  - wait_for_trigger:
    - platform: device
      device_id: e9121935f1d5a2f516790f9a116fa1f0
      domain: media_player
      entity_id: media_player.living_room_tv
      type: paused
    - platform: device
      type: turned_off
      device_id: e9121935f1d5a2f516790f9a116fa1f0
      entity_id: remote.living_room_tv
      domain: remote
    - platform: device
      device_id: e9121935f1d5a2f516790f9a116fa1f0
      domain: media_player
      entity_id: media_player.living_room_tv
      type: idle
  - service: light.turn_on
    data:
      transition: 2
      color_temp: 380
      brightness_pct: 90
    target:
      area_id: living_room
  mode: single
- id: '1655193271561'
  alias: 'Hallway - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.hallway_presence
    to: 'on'
    from: 'off'
  condition: []
  action:
  - type: turn_on
    device_id: 7f77499815c8499f7cf2c3d9d98b7704
    entity_id: switch.hallway_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.hallway_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: 7f77499815c8499f7cf2c3d9d98b7704
    entity_id: switch.hallway_shelly
    domain: switch
  mode: single
- id: '1655195999380'
  alias: 'Living Room - Lights: Auto Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.living_room_presence
    from: 'off'
    to: 'on'
  condition: []
  action:
  - service: light.turn_on
    data:
      color_temp: 153
      brightness_pct: 100
    target:
      entity_id: light.living_room_tv_light
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.living_room_presence
      from: 'on'
      to: 'off'
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.living_room_tv_light
  mode: single
- id: '1655219551824'
  alias: 'Bedroom - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.bedroom_presence
    from: 'off'
    to: 'on'
  - platform: numeric_state
    entity_id: sensor.bedroom_motion_illuminance_3
    below: '25'
  - platform: time_pattern
    minutes: /5
  condition:
  - condition: time
    after: 07:00:00
    before: '21:00:00'
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
    - sat
    - sun
  - type: is_illuminance
    condition: device
    device_id: 1040b71ce8f05d1677448fabcc133421
    entity_id: sensor.bedroom_motion_illuminance_3
    domain: sensor
    below: 25
  - condition: state
    entity_id: input_boolean.bedroom_presence
    state: 'on'
  action:
  - type: turn_on
    device_id: f495569fb2a00ec0399e951b59bd1752
    entity_id: switch.bedroom_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.bedroom_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: f495569fb2a00ec0399e951b59bd1752
    entity_id: switch.bedroom_shelly
    domain: switch
  mode: single
- id: '1655225694008'
  alias: 'Baby Room - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.baby_room_presence
    from: 'off'
    to: 'on'
  condition:
  - condition: time
    after: 07:00:00
    before: '21:00:00'
    weekday:
    - mon
    - tue
    - wed
    - fri
    - thu
    - sat
    - sun
  action:
  - type: turn_on
    device_id: cb8d313b8527e3f3aee85ad48b26da45
    entity_id: switch.baby_room_shelly
    domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.baby_room_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: cb8d313b8527e3f3aee85ad48b26da45
    entity_id: switch.baby_room_shelly
    domain: switch
  mode: single
- id: '1655228112348'
  alias: 'Bedroom - Tv: Turn Off'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.bedroom_presence
    from: 'on'
    to: 'off'
  condition: []
  action:
  - type: turn_off
    device_id: 2488b94619cead138686380c1c220fec
    entity_id: remote.bedroom_tv
    domain: remote
  mode: single
- id: '1655239522976'
  alias: 'Landing - Light: Manage'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.landing_presence
    from: 'off'
    to: 'on'
  - platform: time_pattern
    minutes: /1
  condition:
  - condition: state
    entity_id: input_boolean.landing_presence
    state: 'on'
  action:
  - if:
    - condition: time
      after: 07:00:00
      before: '21:00:00'
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
    then:
    - type: turn_on
      device_id: 4c70181f7f4a76ac11e9c2bcb72a74f9
      entity_id: switch.landing_shelly
      domain: switch
  - wait_for_trigger:
    - platform: state
      entity_id:
      - input_boolean.landing_presence
      from: 'on'
      to: 'off'
  - type: turn_off
    device_id: 4c70181f7f4a76ac11e9c2bcb72a74f9
    entity_id: switch.landing_shelly
    domain: switch
  mode: single
- id: '1655749208565'
  alias: 'Supply Closet - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.supply_closet_presence
      presence_indicator_entity_ids:
      - binary_sensor.supply_closet_door_contact
      presence_hint_entity_ids:
      - binary_sensor.supply_closet_shelly_input
      presence_timeout: 0
- id: '1655751397719'
  alias: 'Toilet - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.toilet_presence
      presence_indicator_entity_ids: []
      presence_hint_entity_ids:
      - binary_sensor.toilet_shelly_channel_1_input
      - binary_sensor.toilet_door_contact
      presence_timeout: 180
- id: '1655751783256'
  alias: 'Driveway - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.driveway_presence
      presence_indicator_entity_ids:
      - binary_sensor.hallway_door_contact
      presence_hint_entity_ids:
      - binary_sensor.driveway_shelly_input
      presence_timeout: 120
- id: '1655752447329'
  alias: 'Bedroom - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.bedroom_presence
      presence_indicator_entity_ids:
      - binary_sensor.bedroom_human_presence
      - binary_sensor.bedroom_motion_home_security_motion_detection_3
      presence_hint_entity_ids:
      - binary_sensor.bedroom_shelly_input
      presence_timeout: 60
- id: '1655752570246'
  alias: 'Hallway - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.hallway_presence
      presence_hint_entity_ids:
      - binary_sensor.hallway_door_contact
      - binary_sensor.hallway_shelly_input
      - binary_sensor.toilet_door_contact
      - binary_sensor.living_room_door_contact
      - binary_sensor.driveway_shelly_input
      presence_timeout: 120
- id: '1655752840815'
  alias: 'Landing - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.landing_presence
      presence_hint_entity_ids:
      - binary_sensor.landing_shelly_input
      - binary_sensor.office_door_contact
      presence_indicator_entity_ids:
      - binary_sensor.baby_room_motion_home_security_motion_detection_2
      - binary_sensor.bedroom_motion_home_security_motion_detection_3
      - binary_sensor.laundry_room_motion_occupancy
      - binary_sensor.motion_sensor_home_security_motion_detection
      presence_timeout: 120
- id: '1655752934365'
  alias: 'Laundry Room - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.laundry_room_presence
      presence_indicator_entity_ids:
      - binary_sensor.laundry_room_motion_occupancy
      presence_hint_entity_ids:
      - binary_sensor.laundry_room_shelly_input
- id: '1655753063582'
  alias: 'Living Room - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.living_room_presence
      presence_indicator_entity_ids:
      - binary_sensor.living_room_dining_table_human_presence
      - binary_sensor.living_room_tv_human_presence
      presence_hint_entity_ids:
      - binary_sensor.living_room_door_contact
      - binary_sensor.supply_closet_door_contact
      - binary_sensor.living_room_shelly_input
      presence_timeout: 60
- id: '1655753137217'
  alias: 'Office - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.office_presence
      presence_indicator_entity_ids:
      - binary_sensor.office_human_presence
      - binary_sensor.motion_sensor_home_security_motion_detection
      presence_hint_entity_ids:
      - binary_sensor.office_door_contact
      - binary_sensor.office_shelly_input
- id: '1655753220517'
  alias: 'Baby Room - Presence: Manage'
  description: ''
  use_blueprint:
    path: diy/presence.yaml
    input:
      presence_entity_id: input_boolean.baby_room_presence
      presence_indicator_entity_ids:
      - binary_sensor.baby_room_motion_home_security_motion_detection_2
      presence_hint_entity_ids:
      - binary_sensor.baby_room_shelly_input
      presence_timeout: 120
- id: '1655755184933'
  alias: 'Driveway - Light: Manage'
  description: ''
  use_blueprint:
    path: diy/auto_lights.yaml
    input:
      presence_entity_id: input_boolean.driveway_presence
      light_entity_ids:
      - switch.driveway_shelly
      start_time: 07:00:00
      end_time: '23:00:00'
      illuminance_entity_id: sensor.illuminance
      illuminance_threshold: 80
