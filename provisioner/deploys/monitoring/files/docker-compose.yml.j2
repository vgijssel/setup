name: monitoring
version: '3.8'
services:
  # https://promhippie.github.io/github_exporter/#getting-started
  github_exporter:
    container_name: github_exporter
    image: promhippie/github-exporter:latest@sha256:14c75bc048503ce67db8f78df77d374c23dc351c291428e82b53a0bce9602bf6
    restart: always
    environment:
      - GITHUB_EXPORTER_TOKEN={{ github_exporter_token }}
      - GITHUB_EXPORTER_LOG_PRETTY=true
      - GITHUB_EXPORTER_ORG=mvgijssel
      - GITHUB_EXPORTER_REPO=mvgijssel/setup
      - GITHUB_EXPORTER_COLLECTOR_WORKFLOWS=true
      - GITHUB_EXPORTER_COLLECTOR_RUNNERS=false
      - GITHUB_EXPORTER_COLLECTOR_BILLING=false
      - GITHUB_EXPORTER_COLLECTOR_ADMIN=false

  nri-prometheus:
    container_name: nri-prometheus
    image: newrelic/nri-prometheus:2.18.1@sha256:cd1b512186551293177fa7c48d85d876f2125c5da5978e03c7a4833b8082bc79
    restart: always
    environment:
      - LICENSE_KEY={{ new_relic_license_key }}
    volumes:
      - "/opt/monitoring/nri-prometheus-config.yaml:/config.yaml"
