language: javascript
layer: library
tags:
  - vendir
  - helm
  - infrastructure
tasks:
  build:
    command: vendir sync
    inputs:
      - file: vendir.yml
      - "@group(vendir_bin)"
    outputs:
      - charts
      - claude-task-master
      - shell
      - vendir.lock.yml
    options:
      cache: true
      cacheKey: v2

  test:
    command: git diff --exit-code vendir.lock.yml charts claude-task-master shell
    deps:
      - ~:build
    inputs:
      - file: vendir.yml
      - file: vendir.lock.yml
      - glob: charts/**/*
      - glob: claude-task-master/**/*
      - glob: shell/**/*
    options:
      cache: true
