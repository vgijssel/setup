 #!/usr/bin/env bash

set -Eeou pipefail

# Currently not possible to use variable interpolation inside the .bazelrc file
# therefore we are generating one dynamically for each job in the CI. 
# See https://github.com/bazelbuild/bazel/issues/10904
echo "build --disk_cache $(pwd)/tmp/bazel/disk_cache" > "$(pwd)/ci.bazelrc"
echo "build --repository_cache $(pwd)/tmp/bazel/repository_cache" >> "$(pwd)/ci.bazelrc"
echo "startup --output_base=$(pwd)/tmp/bazel/output_base" >> "$(pwd)/ci.bazelrc"

cat "$(pwd)/ci.bazelrc"