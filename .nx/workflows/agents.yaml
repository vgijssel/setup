launch-templates:
  linux-hermit-medium:
    resource-class: 'docker_linux_amd64/medium'
    image: 'ubuntu22.04-node20.11-v9'
    init-steps:
      - name: Checkout
        uses: 'nrwl/nx-cloud-workflows/v5/workflow-steps/checkout/main.yaml'
      - name: Setup direnv
        script: |
          bin/direnv allow
      - name: Check NX_CLOUD_ENV
        script: |
          cat $NX_CLOUD_ENV
      - name: Export direnv environment
        script: |
          bin/direnv export json | bin/jq -r 'to_entries[] | "\(.key)=\(.value)"' >> $NX_CLOUD_ENV
      - name: Print the environment
        script: |
          env
     - name: Check Hermit version
       script: |
         hermit --version

  linux-hermit-large:
    resource-class: 'docker_linux_amd64/large'
    image: 'ubuntu22.04-node20.11-v9'
    init-steps:
      - name: Checkout
        uses: 'nrwl/nx-cloud-workflows/v5/workflow-steps/checkout/main.yaml'
      - name: Setup direnv
        script: |
          bin/direnv allow
      - name: Export direnv environment
        script: |
          eval $(direnv exec / direnv export bash)
          echo "NX_CLOUD_ENV=$(direnv exec / direnv export bash)" >> $GITHUB_ENV
        env:
          NX_CLOUD_ENV: ""
      - name: Validate Hermit
        script: |
          hermit --version