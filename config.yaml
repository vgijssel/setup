receivers:
  otlp:
    protocols:
      grpc:
        endpoint: "0.0.0.0:4317"

exporters:
  logging:
    verbosity: detailed

  logzio/traces:
    account_token: ${file:/etc/otel/logzio_exporter.yaml}
    region: "us"

processors:
  batch:
  tail_sampling:
    policies:
      [
        {
          name: policy-errors,
          type: status_code,
          status_code: { status_codes: [ERROR] },
        },
        { name: policy-slow, type: latency, latency: { threshold_ms: 1000 } },
        {
          name: policy-random-ok,
          type: probabilistic,
          probabilistic: { sampling_percentage: 10 },
        },
      ]

extensions:
  # pprof:
  #   endpoint: :1777
  # zpages:
  #   endpoint: "0.0.0.0:55679"
  health_check:
    endpoint: "0.0.0.0:13133"

service:
  # extensions: [health_check, zpages]
  # extensions: [health_check, zpages]
  extensions: [health_check]
  pipelines:
    traces:
      receivers: [otlp]
      processors: [tail_sampling, batch]
      exporters: [logging, logzio/traces]

  telemetry:
    logs:
      level: debug #activate debug mode
# docker run  \
# -v /Users/maarten/Development/setup/config.yaml:/etc/otelcol/config.yaml \
# -p 55678-55680:55678-55680 \
# -p 1777:1777 \
# -p 9411:9411 \
# -p 9943:9943 \
# -p 6831:6831 \
# -p 6832:6832 \
# -p 14250:14250 \
# -p 14268:14268 \
# -p 4317:4317 \
# -p 55681:55681 \
# otel/opentelemetry-collector-contrib:0.60.0
