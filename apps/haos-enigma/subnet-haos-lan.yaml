# KubeOVN Underlay Subnet for HAOS Admin LAN connectivity
# This subnet provides direct Layer 2 access to the 192.168.1.0/24 admin LAN network
# with DHCP for automatic IP assignment from the physical LAN router
---
apiVersion: kubeovn.io/v1
kind: Subnet
metadata:
  name: haos-lan
spec:
  # IPv4 only (KubeOVN version doesn't support dual-stack fields)
  protocol: IPv4
  # Provider must match the NetworkAttachmentDefinition <name>.<namespace>.ovn
  provider: haos-lan.tenant-root.ovn
  # Bind to the untagged VLAN on eno1 provider network
  vlan: eno1-native
  # IPv4 configuration - Admin LAN network CIDR
  cidrBlock: 192.168.1.0/24
  # Physical router IPv4 gateway
  gateway: 192.168.1.1
  # Disable gateway check - physical gateway may not respond to ARP/ICMP from OVS bridge
  disableGatewayCheck: true
  # No NAT - true underlay/bridged networking
  natOutgoing: false
  # DHCP enabled - let the LAN DHCP server assign IPs
  enableDHCP: true
  # DHCPv4 options (empty to use LAN DHCP server settings)
  dhcpV4Options: ""
  # Exclude IPs that are known to be in use on the physical network
  # Since we're bridging to a real LAN, most IPs are already in use by physical devices
  # Only allow a narrow range that's specifically reserved for VMs
  excludeIps:
    # Exclude everything except 192.168.1.150-192.168.1.159 (reserved for VMs)
    - 192.168.1.1..192.168.1.149
    - 192.168.1.160..192.168.1.254
  # Allow traffic between overlay and underlay if needed
  u2oInterconnection: false
