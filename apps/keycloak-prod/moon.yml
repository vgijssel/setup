language: javascript
layer: application
tags:
  - app
  - terraform
  - keycloak
  - infrastructure
tasks:
  init:
    command: tofu init -backend-config=/secrets/keycloak-prod/backend.hcl
    options:
      runInCI: false

  plan:
    command: tofu plan -var-file=/secrets/keycloak-prod/secrets.tfvars
    deps:
      - ~:init
    options:
      runInCI: false

  apply:
    command: tofu apply -auto-approve -var-file=/secrets/keycloak-prod/secrets.tfvars
    deps:
      - ~:init
    options:
      runInCI: false
      interactive: true

  destroy:
    command: tofu destroy -auto-approve -var-file=/secrets/keycloak-prod/secrets.tfvars
    deps:
      - ~:init
    options:
      runInCI: false
      interactive: true

  output:
    command: tofu output
    deps:
      - ~:init
    options:
      runInCI: false
