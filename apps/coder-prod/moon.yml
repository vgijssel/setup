language: javascript
layer: application
tags:
  - stack
  - kubernetes
  - production
  - stack
  - kubernetes
  - production
tasks:
  create-1password-secret:
    command: kubectl create namespace 1password || true && kubectl create secret generic 1password-credentials --namespace=1password --from-literal=1password-credentials.json=\"$(op read 'op://setup-coder-prod/coder-prod Credentials File/1password-credentials.json' | base64)\" --dry-run=client -o yaml | kubectl apply -f - && kubectl create secret generic 1password-operator-token --namespace=1password --from-literal=token=\"$(op read 'op://setup-coder-prod/kzsqg7xbgiz7jbvxksugadymne/credential')\" --dry-run=client -o yaml | kubectl apply -f -
    env:
      CWD: "{workspaceRoot}"
    toolchain: system
toolchain:
  default: node
