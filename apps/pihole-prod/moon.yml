id: pihole-prod
language: javascript
layer: application
dependsOn:
  - ansible
tags:
  - scope.app
  - type.infrastructure
  - ansible
  - pihole
tasks:
  install-requirements:
    command: ansible-galaxy collection install -r ../../libs/ansible/requirements.yml
    local: true
  bootstrap:
    command: ansible-playbook -i bootstrap pihole.yml --diff -e "ansible_host=@ARGS"
    local: true
    args:
      passthrough: true
  apply:
    command: ansible-playbook -i inventory pihole.yml --diff
    local: true
