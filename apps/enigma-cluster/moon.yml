language: javascript
layer: application
dependsOn:
  - internal-networking
tags:
  - scope.app
  - type.stack
  - kubernetes
  - production
  - scope.app
  - type.stack
  - kubernetes
  - production
tasks:
  create-1password-secret:
    command: kubectl create secret generic 1password-credentials --namespace=1password --from-literal=1password-credentials.json=\"$(op read 'op://enigma-cluster/enigma-cluster Credentials File/1password-credentials.json' | base64)\" --dry-run=client -o yaml | kubectl apply -f - && kubectl create secret generic 1password-operator-token --namespace=1password --from-literal=token=\"$(op read 'op://enigma-cluster/hxmp2hgt5iluzk5zfq2trx4oae/credential')\" --dry-run=client -o yaml | kubectl apply -f -
    env:
      CWD: "{workspaceRoot}"
    local: true
