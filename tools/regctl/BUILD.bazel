load("@rules_task//:defs.bzl", "cmd", "task")

package(default_visibility = ["//visibility:public"])

regctl_file = select({
    "@platforms//cpu:aarch64": ["@regctl_arm64//file:file"],
    "@platforms//cpu:x86_64": ["@regctl_amd64//file:file"],
})

sh_binary(
    name = "regctl_binary",
    srcs = regctl_file,
)

task(
    name = "regctl",
    cmds = [
        cmd.shell(
            cmd.executable(":regctl_binary"),
            "$CLI_ARGS",
        ),
    ],
)
